# ps

```shell
ps # 프로세스 리스트
ps aux # 백그라운드 프로세스까지 출력
ps aux | grep gnome # 모든 프로세스 중에서 gnome부분만 출력
```

# top, htop

* 프로세스를 좀 더 체계적으로 보여주는 명령어로 htop은 좀더 그래피컬하다.
* MEM%는 물리적 메모리 사용량이고 RES가 실제 메모리 사용량이다.
* Load average는 1분, 5분, 15분의 CPU 점유율 평균을 낸 것이다. (부하를 짐작할 수 있다.)
* 숫자 1,2,3..은 CPU 코어를 말한다.

# 백그라운드 실행

* Ctrl + z : 백그라운드로 보낸다.

```shell
jobs # 백그라운드로 실행중인 프로그램 리스트
# +가 제일 첫번째 -가 두번째, 그리고 아무것도 없는 것부터 3번째
fg # 제일 첫번째 백그라운드 프로그램으로 돌아감
fg %n # n번째 백그라운드 프로그램으로 돌아감
kill %n # n번째 프로그램 종료
```

* & : 백그라운드로 실행한다.

```shell
ls -alR / > result.txt 2> error.log &
# 루트 디렉토리에 대해 ls -al 수행하므로 오래걸린다. -> 백그라운드로 실행하자. &붙임
```

# Daemon

항상 실행되고 있는 프로그램을 얘기한다. 비유로 얘기하자면 전자제품을 들 수 있는데, 냉장고와 TV가 있다고 하자. TV는 항상 켜져있지 않고 필요할 때 키지만 냉장고는 항상 켜져 있다. 비슷한 걸로는 모뎀이나 전자도어락 같은 것들이 있다. 이런 것들은 어떤 이유 때문에 항상 켜져있을까? 언제 사용할지 모르기 때문이다.

컴퓨터에선 서버가 데몬에 해당된다. 특정 웹페이지에 접속한다고 했을 때 웹브라우저를 통해서 해당 웹페이지를 가지고 있는 서버에 요청하게 된다. 웹브라우저는 필요할 때만 키면 되지만 서버는 웹브라우저인 클라이언트가 언제 접속할지를 모른다. 따라서 서버에 설치되어 있는 웹서버는 항상 켜져 있어야 한다. 이러한 프로그램을 데몬이나 서비스라고 한다.

```shell
# /etc/init.d 디렉토리에 데폰 프로그램들이 위치하며
# 대부분의 데몬 프로그램들은 start와 stop 명령어를 가진다
# 웹서버인 apache2를 깔았다고 치자.
service apache2 start # 데몬 프로그램은 service를 이용해서 start로 실행해야 한다.
service apache2 stop # 마찬가지로 끌 때도 service + stop을 이용해야 한다.

# /etc/rc3.d 디렉토리엔 콘솔로 부팅했을 때 실행되는 프로그램 리스트가 있다.
# K로 시작하면 실행되지 않는 것이고 S로 시작하면 실행되는 것이며 소프트링크로 되어있다.
# 숫자들은 우선순위를 말한다.
ls -lR /etc/rc3.d/ | grep apache2
# 실행하면 S02apache2 -> ../init.d/apache2가 출력됨
```

# Cron

정기적으로 명령을 실행시켜주는 프로그램

```shell
crontab -e # 명령어 정의할 때 에디터를 연다.
*/1 * * * * date >> date.log 2>&1
# 1분에 1번씩 date를 실행하고 date.log 파일에 저장 
# 에러가 발생하면 표준 출력으로 리다이렉션하는 명령어를 crontab으로 설정
crontab -l # 정의한 cron 출력
```

# Staㅇrtup Script

쉘을 시작할 때 프로그램이 실행되도록 할 수 있다.

```shell
# bash 쉘을 예로 들면, .bashrc 파일에 명령어를 입력하면 쉘이 시작될 때 실행된다.
nano .bashrc # echo 'hello, bash!'라고 입력하고 저장했다고 하자.
bash # bash 쉘 시작
# hello, bash! 라고 뜬다.
```

# 웹서버(아파치)

클라이언트 프로그램인 웹브라우저는 서버 프로그램인 웹서버에 요청을 하고 해당 웹페이지를 받아와서 화면에 띄워주게 된다. 웹브라우저에는 IE, Chrome, FireFox 등이 있고 웹서버에는 apache, nginx, IIS 등이 있다. 여기선 apache를 활용하는 방법을 배울 것이다.

apache를 설치하고 실행해보자. (apache2를 설치해야 함)

```shell
sudo apt-get install apache2
sudo service apache start # 아파치 실행
sudo service apache stop # 아파치 종료
sudo service apache restart # 아파치 재부팅
```

`htop`을 이용해서 돌아가고 있는 프로세스를 확인하면 여러개의 아파치가 동작하고 있는 것을 알 수 있는데 그 이유는 웹서버는 쉬지 않고 여러명의 클라이언트로부터 계속 요청을 받기 때문에 **분산 처리를 위해서 여러개가 동시에 돌아간다고 이해하면 된다.**

실제 웹브라우저를 통해 접속할 때는 많은 난관이 있을 때가 있으므로 쉘에서 웹브라우징을 할 수 있는 프로그램으로 접속해보자.

## elinks

```shell
sudo apt-get install elinks
elinks
```

실행하면 그래픽이 좋지는 않지만 그래도 접속해서 웹브라우징을 할 수 있다. 만약, 웹브라우저로 현재 돌아가고 있는 웹서버에 요청할 수 없다면 이걸 이용하자.

웹브라우저나 elinks나 모두 로컬 환경에선 ip주소를 이용해야 하므로 `ip addr`로 ip주소를 확인한 후에 `http://ip주소/`를 쳐주면 우분투 웹서버 메인 페이지에 접속할 수 있다. 또한 실습환경이 컴퓨터 1대인 경우이므로 웹브라우징을 하는 컴퓨터에 설치된 웹서버의 의미로 쓰는 `localhost`나 아니면 그 localhost의 특별한 ip주소인 `127.0.0.1`을 이용할 수 있다.